<mat-toolbar>
  <h4>
    {{ "MODULES.MODULE-TRY.TITLE" | translate }}:
    <strong>{{ deploymentTitle }}</strong>
  </h4>
</mat-toolbar>

<form class="example-form" [formGroup]="showHelpForm" ngNativeValidate>
  <div class="breadcrumbs-and-help-container">
    <xng-breadcrumb class="mb-3"></xng-breadcrumb>
    <mat-slide-toggle color="accent" formControlName="showHelpToggleButton" #showHelpToggle>
      Show help
    </mat-slide-toggle>
  </div>
</form>

<div *ngIf="showProgress">
  <mat-progress-bar class="mt-2" mode="indeterminate" color="accent"></mat-progress-bar>
</div>

<form [formGroup]="trymeFormGroup"  *ngIf="!showPrediction">
  <h4>{{ "MODULES.MODULE-TRY.TRYME-FORM.LAUNCH-OPTIONS" | translate }}</h4>
  <div class="form-grid">
    <mat-form-field appearance="fill">
      <mat-label>{{
        "MODULES.MODULE-TRY.TRYME-FORM.SERVICE-NAME" | translate
        }}</mat-label>
      <mat-select formControlName="serviceNameInput">
        <mat-option *ngFor="let service of servicesNames" [value]="service">
          {{ service }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>{{
        "MODULES.MODULE-TRAIN.GENERAL-CONF-FORM.DOCKER-IMAGE" | translate
        }}</mat-label>
      <input matInput placeholder="" formControlName="dockerImageInput" />
    </mat-form-field>
  </div>

  <h4>{{ "MODULES.MODULE-TRY.TRYME-FORM.INPUT-OPTIONS" | translate }}</h4>
  <mat-divider class="mt-3 mb-3"></mat-divider>
  <div class="form-grid">
    <mat-form-field class="form-field-full-width">
      <mat-label>{{ "MODULES.MODULE-TRY.TRYME-FORM.INPUT-FILE-LABEL" | translate }}</mat-label>
      <input matInput [value]="fileName" class="upload-file-icon" (click)="inputFile.click()" readonly>
      <mat-icon matIconSuffix (click)="inputFile.click()" class="upload-file-icon">
        attach_file_add</mat-icon>
      <input type="file" class="input-file" #inputFile (change)="selectFile($event)" formControlName="inputFile"
        hidden />
    </mat-form-field>
    <mat-form-field>
      <mat-label>{{
        "MODULES.MODULE-TRY.TRYME-FORM.INPUT-TEXT-LABEL" | translate
        }}</mat-label>
      <textarea type="text" matInput placeholder="" formControlName="inputText"></textarea>
    </mat-form-field>
  </div>

  <h4>{{ "MODULES.MODULE-TRY.TRYME-FORM.OUTPUT-OPTIONS" | translate }}</h4>
  <mat-divider class="mt-3 mb-3"></mat-divider>
  <div class="form-grid">
    <mat-form-field appearance="fill">
      <mat-label>{{
        "MODULES.MODULE-TRY.TRYME-FORM.OUTPUT-TYPES.LABEL" | translate
        }}</mat-label>
      <mat-select formControlName="outputType" required>
        <mat-option value="image">
          {{ "MODULES.MODULE-TRY.TRYME-FORM.OUTPUT-TYPES.IMAGE" | translate }}
        </mat-option>
        <mat-option value="audio">
          {{ "MODULES.MODULE-TRY.TRYME-FORM.OUTPUT-TYPES.AUDIO" | translate }}
        </mat-option>
        <mat-option value="text">
          {{ "MODULES.MODULE-TRY.TRYME-FORM.OUTPUT-TYPES.TEXT" | translate }}
        </mat-option>
        <mat-option value="video">
          {{ "MODULES.MODULE-TRY.TRYME-FORM.OUTPUT-TYPES.VIDEO" | translate }}
        </mat-option>
        <!--mat-option value="zip" disabled>
          {{ "MODULES.MODULE-TRY.TRYME-FORM.OUTPUT-TYPES.ZIP" | translate }}
        </mat-option-->
      </mat-select>
    </mat-form-field>
  </div>

  <div class="next-back-buttons">
    <a class="mb-3 interact-button" mat-raised-button color="accent" (click)="launchModel()">
        {{"MODULES.MODULE-TRY.TRYME-FORM.LAUNCH-BUTTON" | translate}}
    </a>
</div>
</form>

<mat-divider></mat-divider>

<div class="prediction-container" *ngIf="showPrediction">
  <div class="prediction-title">
    <p> Inference resutls </p>
  </div>

  <div class="prediction-item">
    <ng-template ngFor let-i="index" let-prediction [ngForOf]="predictionData">
      <div *ngIf="i < 3" [ngClass]="{ 'custom-text-shadow': i == 0 }" class="result-container">
        <div class="percentage">{{prediction.probability | percent: '2.1-2'}}</div>
        <div class="plant-name">{{prediction.label}}</div>
      </div>

    </ng-template>
  </div>

  <div class="prediction-item">
    <table mat-table [dataSource]="predictionData" class="results-table">

      <!-- Columna de Nombres -->
      <ng-container matColumnDef="label">
        <th mat-header-cell *matHeaderCellDef> Label </th>
        <td mat-cell *matCellDef="let element">{{ element.label }}</td>
      </ng-container>

      <ng-container matColumnDef="probability">
        <th mat-header-cell *matHeaderCellDef> Probability </th>
        <td mat-cell *matCellDef="let element">{{ element.probability | percent: '2.1-3'}}</td>
      </ng-container>

      <ng-container matColumnDef="label_info">
        <th mat-header-cell *matHeaderCellDef> Labels info </th>
        <td mat-cell *matCellDef="let element">{{ element.label_info }}</td>
      </ng-container>

      <ng-container matColumnDef="images">
        <th mat-header-cell *matHeaderCellDef> Images </th>
        <td mat-cell *matCellDef="let element"><a href={{element.images}}> {{ element.images }} </a></td>
      </ng-container>

      <ng-container matColumnDef="info">
        <th mat-header-cell *matHeaderCellDef> More Info </th>
        <td mat-cell *matCellDef="let element"><a href={{element.info}}> {{ element.info }} </a></td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>
</div>


